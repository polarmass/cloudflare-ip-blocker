jQuery(document).ready(function(t){t(".cfip-show-token-instructions").on("click",function(i){i.preventDefault(),t("#cfip-token-instructions").fadeIn(300),t("body").addClass("cfip-modal-open")}),t("#cfip-close").on("click",function(){t("#cfip-token-instructions").fadeOut(300),t("body").removeClass("cfip-modal-open")}),t("#cfip-token-instructions").on("click",function(i){t(i.target).is("#cfip-token-instructions")&&(t("#cfip-token-instructions").fadeOut(300),t("body").removeClass("cfip-modal-open"))}),t("#cfip-block-ip").on("click",function(){var i=t("#cfip-ip-input").val().trim();i?confirm(cfipAdmin.i18n.confirmBlock)&&t.ajax({url:cfipAdmin.ajaxUrl,type:"POST",data:{action:"cfip_block_ip",nonce:cfipAdmin.nonce,ip:i},beforeSend:function(){t("#cfip-block-ip").prop("disabled",!0)},success:function(i){i.success?(alert(i.data.message),t("#cfip-ip-input").val(""),location.reload()):alert(i.data.message||cfipAdmin.i18n.error)},error:function(){alert(cfipAdmin.i18n.error)},complete:function(){t("#cfip-block-ip").prop("disabled",!1)}}):alert(cfipAdmin.i18n.enterIp)}),t("#cfip-unblock-ip").on("click",function(){var i=t("#cfip-ip-input").val().trim();i?confirm(cfipAdmin.i18n.confirmUnblock)&&t.ajax({url:cfipAdmin.ajaxUrl,type:"POST",data:{action:"cfip_unblock_ip",nonce:cfipAdmin.nonce,ip:i},beforeSend:function(){t("#cfip-unblock-ip").prop("disabled",!0)},success:function(i){i.success?(alert(i.data.message),t("#cfip-ip-input").val(""),location.reload()):alert(i.data.message||cfipAdmin.i18n.error)},error:function(){alert(cfipAdmin.i18n.error)},complete:function(){t("#cfip-unblock-ip").prop("disabled",!1)}}):alert(cfipAdmin.i18n.enterIp)}),t("#cfip-log-level").on("change",function(){let i=t(this).val();(i?(t(".cfip-log-entries tr").hide(),t(".cfip-log-entries tr:first").show(),t(".cfip-log-entries tr").filter(function(){return t(this).find("td:eq(1)").text().toLowerCase()===i})):t(".cfip-log-entries tr")).show()}),t("#cfip-export-logs").on("click",function(){window.location.href=cfipAdmin.ajaxUrl+"?action=cfip_export_logs&nonce="+cfipAdmin.nonce}),t("#cfip-ip-input").on("input",function(){var i=t(this).val().trim();!i||/^(\d{1,3}\.){3}\d{1,3}$/.test(i)||/^([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}$/.test(i)?t(this).removeClass("error"):t(this).addClass("error")}),t("#cfip-sync-wordfence").on("click",function(){confirm(cfipAdmin.i18n.confirmSync)&&t.ajax({url:cfipAdmin.ajaxUrl,type:"POST",data:{action:"cfip_sync_wordfence",nonce:cfipAdmin.nonce},beforeSend:function(){t("#cfip-sync-wordfence").prop("disabled",!0)},success:function(i){i.success?(alert(i.data.message),location.reload()):alert(i.data.message||cfipAdmin.i18n.error)},error:function(){alert(cfipAdmin.i18n.error)},complete:function(){t("#cfip-sync-wordfence").prop("disabled",!1)}})}),cfipAdmin.isSubscribed?(t(".cfip-newsletter-form").hide(),t(".cfip-newsletter").append('<div class="cfip-newsletter-success"><p>You are already subscribed!</p></div>')):t(".cfip-newsletter-form").on("submit",function(i){i.preventDefault();i=t(this).find('input[type="email"]').val();let n=t(".cfip-newsletter-message"),e=t(this).find("button"),c=t(this);t(".cfip-newsletter");t.ajax({url:"https://polarmass.com/wp-json/cfip/v1/newsletter/signup",type:"POST",contentType:"application/json",data:JSON.stringify({email:i}),beforeSend:function(){e.prop("disabled",!0),c.css("opacity","0.5")},success:function(i){i.success?(c.fadeOut(300,function(){var i=t('<div class="cfip-newsletter-success"><p>Thank you for subscribing to our newsletter!</p></div>').hide();t(this).after(i),i.fadeIn(300)}),t.ajax({url:cfipAdmin.ajaxUrl,type:"POST",data:{action:"cfip_update_newsletter_status",nonce:cfipAdmin.nonce}})):n.removeClass("success").addClass("error").text(i.data.message).fadeIn()},error:function(){n.removeClass("success").addClass("error").text(cfipAdmin.i18n.error).fadeIn()},complete:function(){e.prop("disabled",!1),c.css("opacity","1"),setTimeout(function(){n.fadeOut()},5e3)}})})});